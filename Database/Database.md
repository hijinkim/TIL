# Database 기초 정리



## 데이터베이스

### 데이터베이스 정의

> 특정 조직의 여러 사용자가 공유하여 사용할 수 있도록 통합하여 저장한 운영 데이터의 집합

* 공유 데이터 : 여러 응용 시스템들이 공동으로 소유하고 유지하는 데이터
* 통합 데이터 : 검색의 효율성을 위해 중복이 최소화된 데이터의 모임
* 저장 데이터 : 컴퓨터가 접근할 수 있는 저장 매체에 저장된 데이터
* 운영 데이터 : 조직의 고유한 업무를 수행하는 데 존재 가치가 확실하고 없어서는 안 될 반드시 필요한 데이터



### 데이터 베이스 특성

* 실시간 접근 가능
* 계속 변화
* 동시 공유 가능
* 내용 기반 참조



## DBMS

> 사용자와 데이터베이스 사이에서 사용자의 요구에 따라 정보를 생성해주고, 데이터베이스를 관리해주는 소프트웨어



### 주요 기능

* 정의 기능 : 데이터베이스 구조를 정의하거나 수정할 수 있다.
* 조작 기능 : 데이터 삽입, 삭제, 수정, 검색 연산 가능, 사용자와 데이터베이스 사이의 인터페이스 수단 제공
* 제어 기능 : 데이터를 항상 정확하고 안전하게 유지, 데이터의 무결성 유지되도록 제어



### DBMS 종류

* 계층형 DBMS
  * 트리 구조를 이용하여 데이터의 상호관계를 계층적으로 정의
  * 개체 타입 간 상위, 하위 관계 존재
  * 1:N 대응 관계만 존재
* 망형 DBMS 
  * 그래프 이용하여 데이터 논리 구조 표현
  * 상위, 하위 레코드 사이에서 1:1, 1:N. N:M 대응 관계 지원
* 관계형 DBMS
  * 계층형과 망형 DBMS의 복잡한 구조를 단순화시킨 가장 널리 사용되는 DBMS
  * 2차원적인 표를 하나의 DB로 묶어서 테이블 내에 있는 속성들 간의 관계를 설정하거나 테이블 간 관계 설정하여 이용



### DBMS 장점

* 데이터 중복 통제 가능
* 데이터 독립성 확보
* 데이터 동시 공유
* 데이터 보안 향상
* 데이터 무결성 유지
* 표준화 가능
* 장애 발생 시 회복 가능
* 응용 프로그램 개발 비용 감소



### DBMS 단점

* 비용 많이 듦
* 백업과 회복 방법 복잡함
* 중앙 집중 관리로 인한 취약점 존재



## 데이터베이스 시스템

> 데이터베이스에 데이터를 저장하고 저장된 데이터를 관리하여 조직에 필요한 정보를 생성해주는 시스템
>
> 사용자, 데이터 언어, 데이터베이스 관리 시스템, 데이터베이스, 컴퓨터로 구성



### 3단계 데이터베이스 구조

> 스키마 : 데이터베이스에 저장되는 데이터 구조와 제약조건 정의

* 외부 단계
  * 개별 사용자 관점에서 이해하고 표현
  * 사용자에게 필요한 데이터베이스 정의 외부 스키마 여러 개 존재
* 개념 단계 
  * 조직 전체의 관점에서 이해하고 표현
  * 데이터베이스 전체의 논리적 구조를 정의하는 개념 스키마 하나만 존재
* 내부 단계
  * 저장 장치의 관점에서 이해하고 표현
  * 데이터베이스가 저장장치에 저장되는 방법을 정의한 내부 스키마가 하나만 존재



### 데이터 독립성

* 논리적 데이터 독립성 : 개념 스키마가 변경되어도 외부 스키마는 영향을 받지 않음
* 물리적 데이터 독립성 : 내부 스키마가 변경되어도 개념 스키마는 영향을 받지 않음



### 데이터베이스 사용자

* 데이터베이스 관리자
* 최장 사용자
* 응용 프로그래머



### 데이터 언어

* 데이터 정의어(DDL) : 스키마를 정의하거나 수정, 삭제하기 위해서 사용
* 데이터 조작어(DML) : 데이터의 삽입, 삭제, 수정, 검색 등의 처리를 요구하기 위해서 사용
* 데이터 제어어(DCL) : 동시 공유가 가능하면서도 무결성과 일관성을 유지하도록 내부적으로 필요한 규칙이나 기법들을 정의하기 위해 사용



### 데이터베이스 관리 시스템

* 질의 처리기
* 저장 데이터 관리자



## 데이터 모델링

> 현실 세계에 존재하는 데이터를 컴퓨터 세계의 데이터베이스로 옮기는 변환 과정

* 개념적 데이터 모델링 : 현실 세계의 중요 데이터를 추출하여 개념 세계로 옮기는 작업
* 논리적 데이터 모델링 : 개념 세계의 데이터를 데이터베이스에 저장하는 구조로 표현하는 작업



### 데이터 모델

* 개념적 데이터 모델
  * 개체-관계 모델
    * 개체 : 데이터베이스에 표현하려는 것, 사람이 생각하는 개념이나 정보 단위 같은 현실 세계 대상체
    * 속성 : 데이터의 가장 작은 논리적 단위, 파일 구조상 데이터 항목 또는 데이터 필드
    * 관계 : 개체 간의 관계 또는 속성 간의 논리적인 연결
* 논리적 데이터 모델
  * 관계 데이터 모델 : 2차원 테이블 형태
  * 계층 데이터 모델 : 트리 형태
  * 네트워크 데이터 모델 : 그래프 형태



## 관계 데이터 모델

> 개념적 구조를 논리적 구조로 표현하는 논리적 데이터 모델 중 하나
>
> 하나의 개체에 대한 데이터를 릴레이션 하나에 담아 데이터베이스에 저장



### 관계 데이터 모델 용어

* 릴레이션 : 하나의 개체에 관한 데이터를 2차원 테이블의 구조로 저장한 것
* 속성(애트리뷰트) : 릴레이션의 열
* 튜플 : 릴레이션의 행
* 도메인 : 하나의 속성이 가질 수 있는 값들의 집합
* 널 : 아직 모르거나 해당되는 사항이 없음을 표현하는 특별한 값
* 차수 : 속성의 수
* 카디널리티 : 튜플의 수



### 릴레이션과 데이터베이스의 구성

* 릴레이션 스키마 : 릴레이션의 이름과 릴레이션에 포함된 모든 속성의 이름으로 정의하는 릴레이션의 논리적 구조
* 릴레이션 인스턴스 : 어느 한 시점에 릴레이션에 존재하는 튜플들의 집합

* 데이터베이스 스키마 : 데이터베이스를 구성하는 릴레이션 스키마의 모음
* 데이터베이스 인스턴스 : 데이터베이스를 구성하는 릴레이션 인스턴스의 모음



### 릴레이션 특성

* 튜플의 유일성 : 하나의 릴레이션에는 동일한 튜플 존재 불가능
* 튜플의 무순서 : 하나의 릴레이션에서 튜플 사이의 순서는 무의미
* 속성의 무순서 : 하나의 릴레이션에서 속상 사이의 순서는 무의미
* 속성의 원자성 : 속성 값으로 원자 값만 사용 가능



### 키

> 릴레이션에서 튜플들을 구별하는 역할을 하는 속성, 속성들의 집합

* 특성
  * 유일성 : 한 릴레이션에서 모든 튜플은 서로 다른 키 값을 가져야 함
  * 최소성 : 꼭 필요한 최소한의 속성들로만 키를 구성
* 종류
  * 수퍼키 : 한 릴레이션 내에 있는 속성들의 집합으로 구성된 키, 릴레이션을 구성하는 모든 튜플에 대해 유일성 만족, 최소성 만족하지 않음
  * 후보키 : 릴레이션을 구성하는 속성들 중에서 튜플을 유일하게 식별하기 위해 사용되는 속성들의 부분집합, 유일성과 최소성 만족
  * 기본키 : 후보키 중에서 특별히 선정된 키, 중복된 값과 NULL값 가질 수 없음
  * 대체키 : 후보키 중에서 선정된 기본키를 제외한 나머지 후보키
  * 외래키 : 다른 릴레이션의 기본키를 참조하는 속성 또는 속성들의 집합, 릴레이션 간의 관계 표현



### 관계 데이터 모델의 제약조건

* 개체 무결성 제약조건 : 기본키를 구성하는 모든 속성은 NULL값을 가질 수 없음
* 참조 무결성 제약조건 : 외래키는 참조할 수 없는 값을 가질 수 없음



## 이상

> 불필요한 데이터 중복으로 인해 발생하는 부작용
>
> 함수 종속 관계 여러 개를 하나의 릴레이션에 표현하는 경우에 주로 발생

* 삽입 이상 : 테이블에 데이터를 삽입할 때 의도와는 상관없이 원하지 않은 값들로 인해 삽입할 수 없게 되는 현상
* 갱신 이상 : 테이블에서 튜플에 있는 속성 값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에서 불일치성이 생기는 현상
* 삭제 이상 : 테이블에서 한 튜플을 삭제할 때 의도와는 상관없는 값들도 함께 삭제되는, 즉 연쇄 삭제가 발생하는 현상



## 함수 종속

> 어떤 테이블 R에서 X와 Y를 각각 R의 속성 집합의 부분 집합이라 할 때 속성 X의 값 각각에 대해 시간에 관계없이 항상 속성 Y의 값이 오직 하나만 연관되어 있을 때 Y는 X에 함수적 종속
>
> X → Y (X는 결정자, Y는 종속자)

* 완전 함수적 종속 : 속성 Y가 다른 속성 집합 X 전체에 대해 함수적 종속이면서 속성 집합 X의 어더한 진부분 집합 Z에도 함수적 종속이 아닐 때
* 부분 함수적 종속 : 속성 Y가 다른 속성 집합 X 전체에 대해 함수적 종속이면서 속성 집합 X의 임이의 진부분 집합에 대해 함수적 종속



## 정규화

> 함수 종속성을 이용하여 릴레이션을 연관성 있는 속성들로만 구성되도록 분해하여 이상 현상이 발생하지 않는 바람직한 릴레이션으로 만들어 나가는 과정
>
> 테이블을 무손실 분해하는 과정

* 제1정규형 : 도메인이 원자 값으로만 구성
* 제2정규형 : 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속
* 제3정규형 : 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속 아님
* 보이스/코드 정규형 : 모든 결정자가 후보키
* 제4정규형 : 다치 종속 아님
* 제5정규형 : 조인 종속성 이용



## 트랜잭션

> 하나의 작업을 수행하기 위해 필요한 데이터베이스 연산들을 모아놓은 것, 논리적인 작업의 단위



### 특징

* 원자성 : 트랜잭션의 연산이 모두 정상적으로 수행되거나 하나도 수행되지 않아야 함
* 일관성 : 트랜잭션이 수행된 후에도 데이터베이스가 일관성 있는 상태여야 함
* 독립성 : 수행 중인 트랜잭션이 완료될 때까지 다른 트랜잭션들이 중간 연산 결과에 접근할 수 없음
* 지속성 : 트랜잭션이 수행을 완료한 후에 데이터베이스에 반영한 결과는 영구적이어야 함



### 연산

* commit : 작업 완료
* rollback : 작업 취소



## 장애, 회복

> 장애 : 시스템이 제대로 동작하지 않는 상태
>
> 회복 : 장애가 발생했을 때 데이터베이스를 장애가 발생하기 전의 일관된 상태로 복구시키는 것



### 회복 연산

* redo
* undo



### 회복 기법 유형

* 로그 회복 기법
  * 즉시 갱신 회복 : 트랜잭션을 수행하는 도중에 데이터 변경 연산의 결과를 데이터베이스에 즉시 반영
  * 지연 갱신 회복 : 트랜잭션이 부분 완료되면 데이터 변경 연산의 결과를 데이터베이스에 한번에 반영
* 검사 시점 회복 기법
* 미디어 회복 기법



## 로킹 기법

> 트랜잭션들이 동일한 데이터에 동시에 접근하지 못하도록 lock과 unlock 연산으로 제어
>
> 로킹 단위 커질수록 병행성 낮아짐, 제어 쉬워짐

* lock 연산 : 트랜잭션이 데이터에 대한 독점권 요청하는 연산
* unlock 연산 : 트랜잭션이 데이터에 대한 독점권을 반환하는 연산



### 2단계 로킹 규약

> 트랜잭션이 lock과 unlock 연산을 확장 단계와 축소 단계로 나누어 수행
>
> 모든 트랜잭션이 2단계 로킹 규약 준수하면 직렬 가능함 보장

* 확장 단계 : 트랜잭션이 lock 연산만 실행할 수 있고 unlock 연산은 실행할 수 없는 단계
* 축소 단계 : 트랜잭션이 unlock 연산만 실행할 수 있고 lock 연산은 실행할 수 없는 단계







## 참고

https://terms.naver.com/list.nhn?cid=58430&categoryId=58430